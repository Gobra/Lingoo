<html>
<head>
<script src="http://www.google.com/jsapi" language="javascript"></script>
<script language="javascript">

function detectLanguage(query) {
	var text = query.params.valueForKey("text");
	
	google.language.detect(text, function(result) {
		if (!result.error) {
			query.params.setValueForKey(result.language, "langCode");
			root.signalQueryComplete(query);
		}
	});
}

function translateText(query) {
	var text = query.params.valueForKey("text");
	var srcLang = query.params.valueForKey("srcLang");
	var dstLang = query.params.valueForKey("dstLang");
	
	google.language.translate(text, srcLang, dstLang, function(result) {
		if (!result.error) {
			query.params.setValueForKey(result.translation, "translation");
			root.signalQueryComplete(query);
		}
	});
}

function initialize() {
	function signalLoaded() {
		// convert the enum to an array
		var indexer = 0;
		var langArray = new Array();
		for (language in google.language.Languages)
			langArray[indexer++] = { name : language, code : google.language.Languages[language] };
		root.languages = langArray;
		
		// singal we are ready
		root.isReady = true;
	}
	
	google.load("language", "1");
	google.setOnLoadCallback(signalLoaded);
}

initialize();

</script>
</head>
<body>
	<div id="content"></div>
</body>
</html>